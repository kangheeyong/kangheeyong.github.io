---
title: Noise Canceling Network Project 하드웨어 구성
description:
categories:
 - project 1
tags:
---





###  하드웨어

 ![](/assets/project_1/5.JPG)

[이 프로젝트](https://kangheeyong.github.io/project%201/2018/01/13/noise_canceling_project_1/)에서 가장 어려운 것은 아마도 데이터를 어떻게 생성하느냐인 것 같다. 여기서 어려운 점은 mic과 ref라는 두 개의 입력 데이터를 어떻게 동시에 녹음하느냐이다. 처음에 생각한 방법은 컴퓨터에서 나오는 소리는 녹음하면서 동시에 마이크에 있는 소리를 녹음하는 거였다. 하지만 내 실력으로는 순수 소프트웨어로는 불가능 했다. 그래서 하드웨어로 녹음하는 방법을 선택했다.





#### 구성 과정

구성해야 할 하드웨어는 아래와 같다.

![](/assets/2018-02-26/3.png)

어떤 오디오 파일 출력이 있으면 하나는 스피커에 다른 하나는 마이크 채널 2에 연결한다. 그리고 마이크 채널 1에 마이크를 연결한다. Python으로 녹음하면 기본적을 1채널 녹음과 2채널 녹음이 있는데 여기서 간단하게 2채널 녹음을 하면 mic와 ref를 동시에 녹음이 가능하다.

여기서 문제는 컴퓨터 또는 노트북에는 2채널 마이크 입력이 없다는 것이다. 그래서 2채널 녹음이 되는 하드웨어를 찾았다.

![](/assets/2018-02-26/5.jpeg)

위의 하드웨어는 약 3만원 정도이다. 위의 하드웨어와 Y커넥터를 구매해서 출력되는 오디오 신호를 두 개로 나누었다. 그리고 마이크는 usb마이크가 아닌 3.5파이 커넥터를 가지는 클립형 마이크(강의할 때 간단하게 입 근처네 붙이고 쓰는 것)를 사용해서 녹음을 해보았는데 문제가 생겼다.

마이크 바로 앞에서 녹음해야지 겨우 들릴 정도로 녹음 되었다. 여기서 문제의 원인을 마이크 신호의 전압의 세기가 약해서 이런 결과가 나왔다고 결론을 내렸다. 그래서 증폭기를 만들어서 하려고 디바이스마트에서 부품을 찾다가 [음성센서 마이크 앰프(KB4500VC)](http://www.devicemart.co.kr/1153748/support/#support)를 발견했다. 단순한 마이크용 증폭기인 줄 알았으나 마이크에 증폭기가 포함된 모듈이였다. 이 마이크의 설명에서는 10m에서도 사람 음성이 녹음된다고 했다. 그래서 한번 아래와 같이 구매해서 간단하게 마이크를 구성해 보았다.


![](/assets/2018-02-26/4.png)

위의 구성중에서 **DC-003(1.3파이)** 와 **DC-005(2.5)** 는 전원수 암컷 커넥터이다. 이 두 개는 크기만 다를 뿐 역할은 똑같은데 두개를 산 이유는 전원부분의 스팩에서 원하는 암컷 커넥터 크기를 알 수 없었기 때문이다. 정확히는 2.5파이 커넥터이다 이렇게 쓰여지지 않고 위와 같이 **외경 3.0/내경 3.0** 이라고 나와서 혹시 몰라서 비슷해 보이는 것을 샀다.(**DC-005(2.5)** 가 맞는 커넥터 였다.)

    뭔가 부품들의 스팩이 통일되지 않아서 나오는 회사마다 다르게 표기하는 것 같다.  

아래 사진은 구입한 부품을 테스트 하는 장면이다.
![](/assets/2018-02-26/1.jpeg)

먼저 브레드보드에 연결에서 실험을 했다. 결과는 녹음이 잘 되었다.

잘 생각해보면 일반 마이크는 마이크 근처에 있는 소리만 증폭이 된다. 따라서 [음성센서 마이크 앰프(KB4500VC)](http://www.devicemart.co.kr/1153748/support/#support) 보다 민감도가 낮지 않을까 생각한다.

####  최종 하드웨어 구성

![](/assets/2018-02-26/6.jpeg)

위에서 브레드보드에서 실험한 것을 만능기판에 땜질을 했다. 여기까지는 학부생 때 항상 해보던 것이라서 아무런 어려움이 없었다.


#### 고찰

잘 생각해보면 상용마이크와 위의 마이크의 차이점은 목적이 달랐다는 것이다. 이 말이 무슨말이냐면 상용 마이크는 가까운 거리에 있는 신호만 잡아내면 됬었다. 따라서 그에 맞는 하드웨어 설계가 됬던게 아닐까 생각한다. 하지만 이번 프로젝트에 필요한 마이크는 어느 정도 거리가 있는 신호도 잡아낼 수 있어야 한다. 생각해보면 사람의 귀도 어느 정도 멀리 떨어진 거리의 소리도 들을 수 있었다. 따라서 사람의 귀처럼 들을 수 있는 마이크가 필요한 것이였다.

그리고 신호의 세기는 거리의 세제곱의 반비례하는데 이게 어떤 값의 반비례인지 모르겠다. 즉, 무엇을 측정한 값의 반비례로 신호의 세기가 변하는지 모르겠다는 말이다. 이게 측정한 전압의 세기의 반비례인지 측정한 전압을 디지털 값으로 바꿔서 나온 값의 반비례인지 이 디지털 값을 dB값으로 바꿔서 나온 값의 반비계인지.

    그동안 내가 배운것들에서 이런것에 대한 언급이 단 한번도 없었다. 공대에서 배우는 것들은 과학을 응용하는 것들인데 왜 이런것을 배우지 않을까? 가르치는 것을 쉽게하려고? 아니면 기초부터 차근차근하다보니 학부 과정에 못넣어서? 아니면 처음부터 그런게 없었던 것일까?

###  실제 환경 분석

####  두 신호간의 동기화 문제


 ![](/assets/2018-02-26/31.JPG)


위의 신호는 스피커에서 나오는 신호이고 아래는 마이크에 녹음되는 신호이다. 스피커와 마이크 사이 거리가 있기 때문에 실제 녹음을 할 경우 거리 간격만큼 신호의 딜레이가 생겼다.

####  리플 전압(Voltage)


 ![](/assets/2018-02-26/30.JPG)

마이크에 들어가는 전원 어댑터에서 교류전원이 완벽하게 직류가 되지 않아서 교류 신호 일부가 남게 되었다. 전원부분에 교류신호가 있기 때문에 그 잡음이 마이크에 영향을 끼쳐서 위의 그림과 같이 잡음이 생겼다.

####  마이크 신호 단위 변환

이제 알아야 할 것은 실제 마이크 채널에 들어오는 전압들이 dB로 어떻게 변하는지 알아 보았다. 이 것을 알아보는 이유는 학습에 쓰일 데이터는 일반적으로 normalize해서 쓰기 때문이다. 그리고 dB로 바꾸기 전을 입력으로 사용하는게 좋은지 바꾼 후가 입력으로 사용해야 좋은지하는 것도 궁금하기도 했다.


    다음 포스트에...



참조 : [dB(decibel)란 무엇인가?(dBV, dBu, dBSPL, dBFS)](http://audio-probe.com/documentation/db란-무엇인가/), [How can I calculate audio dB level?](https://stackoverflow.com/questions/2445756/how-can-i-calculate-audio-db-level)

###  Data Augmentation - 랜덤 필터 설계

    다음 포스트에...

### 결론

이 프로젝트에서 지금까지 끝낸 것들은 내가 배운 지식들을 모두 활용해서 나올수 있는 결과이다. 즉, 뭔가 새로운 것을 배워서 하는게 아니라 기존의 지식만을 활용하면 여기까지 오는데 그리 오랜시간이 걸리지 않는다는 말이다. 하지만 이 다음 영역은 내가 알지 못하는 영역이다. 어쩌면 새로운 것을 시도할 때 항상 나오는 벽이 아닐까 생각한다. 내 생각에는 이 벽을 넘느냐 못 넘느냐의 차이가 코더(수동적인 것 밖에 못하는 사람?)와 엔지니어(딱히 뭐라고 표현해야 되는지 모르겠음...)의 차이가 아닐까 생각한다.
